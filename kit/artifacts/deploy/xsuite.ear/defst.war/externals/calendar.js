var g_MINY=1601;var g_MAXY=4500;var g_month=0;var g_day=0;var g_year=0;var g_yLow=1990;var multiDate=1;function GetInputDate(K,E){var C=K.length;if(0==C){var A=new Date();g_month=A.getMonth()+1;g_day=A.getDate();g_year=A.getYear();return true;}var I="\0";var L="";var J="";for(var D=0;D<K.length;D++){var G=K.charAt(D);
if(G==" "||G==","||isdigit(G)){continue;}else{if(I=="\0"&&(G=="/"||G=="-"||G==".")){I=G;L=K.substring(D+1,C);}else{if(G==I){J=K.substring(D+1,C);}else{if(G!=I){return false;}}}}}if(0==L.length){return false;}var B;var F;var H;B=atoi(K);F=atoi(L);if(0!=J.length){H=atoi(J);}else{H=DefYr(B,F);}if(H<100){H=1900+H;
while(H<g_yLow){H=H+100;}}if(H<g_MINY||H>g_MAXY||B<1||B>12){return false;}if(F<1||F>GetMonthCount(B,H)){return false;}g_month=B;g_day=F;g_year=H;return true;}function DefYr(A,D){var C=new Date();var B=(C.getYear()<1000)?1900+C.getYear():C.getYear();if(A-1<C.getMonth()||(A-1==C.getMonth()&&D<C.getDate())){return 1+B;
}else{return B;}}function atoi(C){var B=0;for(var A=0;A<C.length;A++){var D=C.charAt(A);if(!isdigit(D)){return B;}else{B=B*10+(D-"0");}}return B;}function isdigit(A){return(A>="0"&&A<="9");}function GetMonthCount(A,C){var B=rgMC[A-1];if((2==A)&&IsLeapYear(C)){B++;}return B;}function IsLeapYear(A){if(0==A%4&&((A%100!=0)||(A%400==0))){return true;
}else{return false;}}var rgMC=new Array(12);rgMC[0]=31;rgMC[1]=28;rgMC[2]=31;rgMC[3]=30;rgMC[4]=31;rgMC[5]=30;rgMC[6]=31;rgMC[7]=31;rgMC[8]=30;rgMC[9]=31;rgMC[10]=30;rgMC[11]=31;var g_eC=null;var g_eCV="";var g_dFmt="mmddyy";var g_fnCB=null;function ShowCalendar(I,N,M,G,K,C,B){var E=document.all.CalFrame;
var J=window.frames.CalFrame;if(B!=null){multiDate=B;}if(null==J.g_fCalLoaded||false==J.g_fCalLoaded){alert("Unable to load popup calendar.\r\nPlease reload the page.");return ;}dtMin=new Date();dtMin.setDate(dtMin.getDate()+G);dtMax=new Date();dtMax.setDate(dtMax.getDate()+K);J.SetMinMax(new Date(dtMin),new Date(dtMax));
g_fnCB=C;if(N==g_eC&&"block"==E.style.display){if(g_eCV!=N.value&&GetInputDate(N.value,g_dFmt)){J.SetInputDate(g_day,g_month,g_year);J.SetDate(g_day,g_month,g_year);g_eCV=N.value;}else{E.style.display="none";}}else{if(GetInputDate(N.value,g_dFmt)){J.SetInputDate(g_day,g_month,g_year);J.SetDate(g_day,g_month,g_year);
}else{if(null!=M&&GetInputDate(M.value,g_dFmt)){J.SetInputDate(g_day,g_month,g_year);J.SetDate(g_day,g_month,g_year);}else{var D=new Date(dtMin);J.SetInputDate(-1,-1,-1);J.SetDate(D.getDate(),D.getMonth()+1,D.getFullYear());}}if(I.offsetLeft+170<I.document.body.clientWidth){E.style.left=I.offsetLeft;
}else{E.style.left=I.offsetLeft-(I.offsetLeft+170-I.document.body.clientWidth);}var F=I.offsetTop;var L=I.offsetHeight;var A=E.style.pixelHeight;var H=document.body.scrollTop;if(F-A>=H&&F+L+A>document.body.clientHeight+H){E.style.top=F-A;}else{E.style.top=F+L;}if("none"==E.style.display){E.style.display="block";
}g_eC=N;g_eCV=N.value;}return false;}function SetDate(d,m,y){var ds="/";g_eC.focus();if(multiDate==1){if(g_eC.value!=""){g_eC.value+=", ";}}else{g_eC.value="";}g_eC.value+=m+ds+d+ds+y;g_eCV=g_eC.value;if(null!=g_fnCB&&""!=g_fnCB){eval(g_fnCB);}}function GetDowStart(){return 0;}function GetDOW2(C,A,D){var B=new Date(D,A-1,C);
return(B.getDay()+(7-GetDowStart()))%7;}function LoadMonths(E){var C=new Date();var A=C.getMonth()+1;var D=C.getFullYear();var B=new Array(E);for(i=0;i<E;i++){B[i]=document.createElement("IMG");B[i].src="../externals/images/cal/w"+GetDOW2(1,A,D)+"d"+GetMonthCount(A,D)+".gif";A++;if(12<A){A=1;D++;}}}LoadMonths(12);
